rm(list=ls())
require(rbenchmark)
nin <- c(seq(1e5, 1e6, by=1e5), 
         seq(2e6, 1e7, by=1e6),
         seq(2e7, 1e8, by=1e7))

## nThreads==2 ----
result2 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g4e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=2),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )

## nThreads==4 ----
result4 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g4e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=4),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )




## nThreads==8 ----
result8 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g8e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g8e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g8e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=8),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )





## nThreads==16 ----
result16 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g8e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g8e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g8e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=16),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )

## nThreads==32 ----
result32 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g8e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g8e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g8e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=32),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )


## nThreads==64 ----
result64 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g8e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g8e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g8e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=64),
  replications=rep(10, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )

## nThreads==128 ----
result128 <- within(benchmark(
  g1e5=gda::rlba(n=nin[1], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g2e5=gda::rlba(n=nin[2], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g3e5=gda::rlba(n=nin[3], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g4e5=gda::rlba(n=nin[4], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g5e5=gda::rlba(n=nin[5], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g6e5=gda::rlba(n=nin[6], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g7e5=gda::rlba(n=nin[7], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g8e5=gda::rlba(n=nin[8], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g9e5=gda::rlba(n=nin[9], b=1, A=.5, mean_v=c(2.4, 1.6),
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g1e6=gda::rlba(n=nin[10], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g2e6=gda::rlba(n=nin[11], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g3e6=gda::rlba(n=nin[12], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g4e6=gda::rlba(n=nin[13], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g5e6=gda::rlba(n=nin[14], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g6e6=gda::rlba(n=nin[15], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g7e6=gda::rlba(n=nin[16], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g8e6=gda::rlba(n=nin[17], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g9e6=gda::rlba(n=nin[18], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g1e7=gda::rlba(n=nin[19], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g2e7=gda::rlba(n=nin[20], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g3e7=gda::rlba(n=nin[21], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g4e7=gda::rlba(n=nin[22], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g5e7=gda::rlba(n=nin[23], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g6e7=gda::rlba(n=nin[24], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g7e7=gda::rlba(n=nin[25], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g8e7=gda::rlba(n=nin[26], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g9e7=gda::rlba(n=nin[27], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  g1e8=gda::rlba(n=nin[28], b=1, A=.5, mean_v=c(2.4, 1.6), 
                 sd_v=c(1, 1.2), t0=.5, nThreads=128),
  replications=rep(5, 1),
  columns=c('test', 'replications', 'elapsed'),
  order=c('test', 'replications')),
  {average = elapsed/replications} )





## CPU ----
# pVec <- c(b1=1, b2=1, A1=.5, A2=.5, mu1=2.4, mu2=1.6, sigma1=1, sigma2=1.2,
#           t01=.5, t02=.5)
# result_cpu <- within(benchmark(
#   c1e5=pda::rlba(n=nin[1], pVec=pVec),
#   c2e5=pda::rlba(n=nin[2], pVec=pVec),
#   c3e5=pda::rlba(n=nin[3], pVec=pVec),
#   c4e5=pda::rlba(n=nin[4], pVec=pVec),
#   c5e5=pda::rlba(n=nin[5], pVec=pVec),
#   c6e5=pda::rlba(n=nin[6], pVec=pVec),
#   c7e5=pda::rlba(n=nin[7], pVec=pVec),
#   c8e5=pda::rlba(n=nin[8], pVec=pVec),
#   c9e5=pda::rlba(n=nin[9], pVec=pVec),
#   c1e6=pda::rlba(n=nin[10], pVec=pVec),
#   c2e6=pda::rlba(n=nin[11], pVec=pVec),
#   c3e6=pda::rlba(n=nin[12], pVec=pVec),
#   c4e6=pda::rlba(n=nin[13], pVec=pVec),
#   c5e6=pda::rlba(n=nin[14], pVec=pVec),
#   c6e6=pda::rlba(n=nin[15], pVec=pVec),
#   c7e6=pda::rlba(n=nin[16], pVec=pVec),
#   c8e6=pda::rlba(n=nin[17], pVec=pVec),
#   c9e6=pda::rlba(n=nin[18], pVec=pVec),
#   c1e7=pda::rlba(n=nin[19], pVec=pVec),
#   c2e7=pda::rlba(n=nin[20], pVec=pVec),
#   c3e7=pda::rlba(n=nin[21], pVec=pVec),
#   c4e7=pda::rlba(n=nin[22], pVec=pVec),
#   c5e7=pda::rlba(n=nin[23], pVec=pVec),
#   c6e7=pda::rlba(n=nin[24], pVec=pVec),
#   c7e7=pda::rlba(n=nin[25], pVec=pVec),
#   c8e7=pda::rlba(n=nin[26], pVec=pVec),
#   c9e7=pda::rlba(n=nin[27], pVec=pVec),
#   c1e8=pda::rlba(n=nin[28], pVec=pVec),
#   replications=rep(5, 1),
#   columns=c('test', 'replications', 'elapsed'),
#   order=c('test', 'replications')),
#   {average = elapsed/replications} )

# save(result16, result32, result64, result128, result_cpu, 
#      file="tests/gspeed.RData")
# save(result16, result32, result64, result128, result_cpu,
#      file="tests/gspeed2.RData")

save(result2, result4, result8,
     file="tests/gspeed248-nopass.RData")
save(result2, result4, result8,
     file="tests/gspeed248-justpass.RData")

